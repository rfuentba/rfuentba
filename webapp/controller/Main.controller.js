sap.ui.define(["zpmdocmedicio/controller/BaseController","sap/ui/Device","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast"],function(e,t,r,a,i,o,s){"use strict";return e.extend("zpmdocmedicio.controller.Main",{onInit:function(){this.oView=this.getView();this.oBundle=this.getResourceBundle();this.initialOModelParameters(this)},initialOModelParameters:function(e){var t;t={Data:new Date,isGraphBVVisible:true,isGraphLAVisible:false,isGraphBVButtonPressed:true,isGraphLAButtonPressed:false,selectedFilterAvisosGraphBV:"",selectedFilterAvisosGraphLA:""};this.setAuxModel(this,"oModelParameters",t)},onInitialise_SmartFilterBar:function(e){var t=this.getView().byId("iSmartFilterAvanReal");var r=t.getVariantManagement();var a=r.getVariantItems();var i;for(var o=0;o<a.length;o++){i=a[o].getProperty("text");if(i.lastIndexOf("BV")!==-1){this.smartFilterVariantDependenciaBV=a[o]}else if(i.lastIndexOf("LA")!==-1){this.smartFilterVariantDependenciaLA=a[o]}}if(this.smartFilterVariantDependenciaBV){r._setSelectedItem(this.smartFilterVariantDependenciaBV)}t.triggerSearch()},onPressButtonLiniaBV:function(e){var t=this.getModel("oModelParameters");if(t){t.setProperty("/isGraphLAVisible",false);t.setProperty("/isGraphLAButtonPressed",false);t.setProperty("/isGraphBVVisible",true);t.setProperty("/isGraphBVButtonPressed",true)}var r=this.getView().byId("iSmartFilterAvanReal");if(r){var a=r.getVariantManagement();if(this.smartFilterVariantDependenciaBV){a._setSelectedItem(this.smartFilterVariantDependenciaBV);a.fireSelect({key:this.smartFilterVariantDependenciaBV.getKey()})}}r.triggerSearch()},onPressButtonLiniaLA:function(e){var t=this.getModel("oModelParameters");if(t){t.setProperty("/isGraphBVVisible",false);t.setProperty("/isGraphBVButtonPressed",false);t.setProperty("/isGraphLAVisible",true);t.setProperty("/isGraphLAButtonPressed",true)}var r=this.getView().byId("iSmartFilterAvanReal");if(r){var a=r.getVariantManagement();if(this.smartFilterVariantDependenciaLA){a._setSelectedItem(this.smartFilterVariantDependenciaLA);a.fireSelect({key:this.smartFilterVariantDependenciaLA.getKey()})}}r.triggerSearch()},readEstacions:function(){var e="/EstacionsSet";var t=this.getOwnerComponent().getModel();var r=this.onSuccessReadEstacions;var a=this.genericErrorCallback;var i="";this.readGenericCall(e,t,r,a,i)},onSuccessReadEstacions:function(e,t){if(t&&t.results&&t.results.length>0){var r=e.formatDataEstacionsReturn(t.results);e.setAuxModel(e,"oModelEstacions",r)}},setModelForGraphBV:function(e,t){var r=e.getModel("oModelEstacions");if(r&&e.graphBV){var a=e.graphBV;a.getBinding("nodes").getModel().refresh(true);a.getModel().refresh(true);var i=a.getToolbar();i.removeContent(i.getContent()[1].sId);var o=new sap.m.Select({selectedKey:"{oModelParameters>/selectedFilterAvisosGraphBV}",forceSelection:false,tooltip:"{i18n>Tooltip.SelectFilterGraph}",change:this.onChangeFilterAvisosGraphBV,items:{path:"oModelClaseEquip>/",template:new sap.ui.core.Item({text:"{oModelClaseEquip>Columna1}",key:"{oModelClaseEquip>Columna}"})}});i.insertContent(o,0)}},setModelForGraphLA:function(e,t){var r=e.getModel("oModelEstacions");if(r&&e.graphLA){var a=e.graphLA;a.getBinding("nodes").getModel().refresh(true);a.getModel().refresh(true);var i=a.getToolbar();i.removeContent(i.getContent()[1].sId);var o=new sap.m.Select({selectedKey:"{oModelParameters>/selectedFilterAvisosGraphLA}",forceSelection:false,tooltip:"{i18n>Tooltip.SelectFilterGraph}",change:this.onChangeFilterAvisosGraphBV,items:{path:"oModelClaseEquip>/",template:new sap.ui.core.Item({text:"{oModelClaseEquip>Columna1}",key:"{oModelClaseEquip>Columna}"})}});i.insertContent(o,0)}},onGraphIsReady:function(e){var t=e.getSource();if(t){t.zoom({zoomLevel:.5});if(this.getView().byId("oDependenciaBVBulletChartPanelId"))this.getView().byId("oDependenciaBVBulletChartPanelId").setHeight("100%");if(this.getView().byId("oDependenciaLABulletChartPanelId"))this.getView().byId("oDependenciaLABulletChartPanelId").setHeight("100%")}},onChangeFilterAvisosGraphBV:function(e){var t=e.getSource();if(t){if(!t.getItemByKey("")){e.getSource().addItem(new sap.ui.core.Item({text:"Tots",key:""}))}var r=e.getParameter("selectedItem");if(r){var a=r.getKey();var i=t.getParent().getParent();var o=i.getId();var s;if(o.lastIndexOf("graphBV")!==-1){s="/BVNodes"}else if(o.lastIndexOf("graphLA")!==-1){s="/LANodes"}var n=i.getModel("oModelEstacions");if(n){var l=n.getProperty(s);if(l&&l.length>0){var u;if(a!==""){for(var v=0;v<l.length;v++){u=l[v].attributes;if(u&&u.length>0){for(var c=0;c<u.length;c++){if(u[c].ClaseEquip===a){u[c].visible=true}else{u[c].visible=false}}}}}else{for(var v=0;v<l.length;v++){u=l[v].attributes;if(u.length>0){for(var c=0;c<u.length;c++){u[c].visible=true}}}}i.getBinding("nodes").getModel().refresh(true);i.getModel().refresh(true)}}}}},readGraficsSet:function(){var e="/GraficsSet";var t=this.getOwnerComponent().getModel();var r=this.onSuccessReadGraficsSet;var a=this.genericErrorCallback;var i="";this.readGenericCall(e,t,r,a,i)},onSuccessReadGraficsSet:function(e,t){if(t&&t.results&&t.results.length>0){var r=e.formatDataGraficsSet(e,t.results);e._setChartPrioritatsData(e)}},formatDataGraficsSet:function(e,t){var r=[],a=[];for(var i=0;i<t.length;i++){t[i].Valors=t[i].Valors.split(";");if(t[i].Grafic==="PRIORITAT"){r.push(t[i])}else if(t[i].Grafic==="CLASE_EQUIP"){a.push(t[i])}}e.setAuxModel(e,"oModelPrioritats",r);e.setAuxModel(e,"oModelClaseEquip",a);var o=new sap.ui.model.json.JSONModel;o.setSizeLimit("9999");o.setData(r);sap.ui.getCore().setModel(o,"oModelPrioritats");o=new sap.ui.model.json.JSONModel;o.setSizeLimit("9999");o.setData(a);sap.ui.getCore().setModel(o,"oModelClaseEquip")},readAvisos:function(){var e="/AvisosSet";var t=this.getOwnerComponent().getModel();var r=this.onSuccessReadAvisos;var a=this.genericErrorCallback;var i="";this.readGenericCall(e,t,r,a,i)},onSuccessReadAvisos:function(e,t){if(t&&t.results&&t.results.length>0){var r=e.formatDataAvisosReturn(e,t.results);e._setChartData(e);e._setChartEquipsData(e)}},formatDataAvisosReturn:function(e,t){var r=[];var a=e.getView().getModel("oModelPrioritats");if(a){var i=a.getData();var o,s,n,l;for(o=0;o<i.length;o++){for(s=0;s<i[o].Valors.length;s++){n=i[o].Valors[s];l=[];l=t.filter(function(e){if(e.Prioritat===i[o].Valors[s]){return e}else return""});if(l.length>0){i[o][n]=l;i[o][n].AvisosQty=l.length}else{i[o][n]=[];i[o][n].AvisosQty=0}}}}r=[];var u=e.getView().getModel("oModelClaseEquip");var v=e.getView().getModel("oModelTotalAvisos");if(u&&v){var c=u.getData();var d=v.getData();for(o=0;o<c.length;o++){l=[];c[o].AvisosQty=0;l=d.filter(function(e){if(e.ClaseEquip===c[o].Columna&&e.Numavis>0){c[o].AvisosQty+=parseInt(e.Numavis);return e}else return""})}}},createChartAvisosRuleRed:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelPrioritats");if(t){var r=t.getData();var a=e.Prioritat;var i=r.filter(function(e){if(e.Columna===a){return e}else return""});if(i.length>0&&i[0].Color==="ERROR"){return true}}};return t},createChartAvisosRuleOrange:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelPrioritats");if(t){var r=t.getData();var a=e.Prioritat;var i=r.filter(function(e){if(e.Columna===a){return e}else return""});if(i.length>0&&i[0].Color==="WARNING"){return true}}};return t},createChartAvisosRuleBlue:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelPrioritats");if(t){var r=t.getData();var a=e.Prioritat;var i=r.filter(function(e){if(e.Columna===a){return e}else return""});if(i.length>0&&i[0].Color==="INFORMATION"){return true}}};return t},createChartAvisosRuleGreen:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelPrioritats");if(t){var r=t.getData();var a=e.Prioritat;var i=r.filter(function(e){if(e.Columna===a){return e}else return""});if(i.length>0&&i[0].Color==="SUCCESS"){return true}}};return t},_setChartEquipsData:function(e,t,r,a){var i=e.getView().getModel("oModelTotalAvisosLinia");var o=e.oBundle;if(i&&t){var s=ChartFormatter.DefaultPattern;var n=e.createChartAvisosRuleRedEquips(e);var l=e.createChartAvisosRuleOrangeEquips(e);var u=e.createChartAvisosRuleBlueEquips(e);var v=e.createChartAvisosRuleGreenEquips(e);t.setVizProperties({plotArea:{dataLabel:{visible:true},dataPointStyle:{rules:[{callback:n,properties:{color:"red"}},{callback:l,properties:{color:"orange"}},{callback:u,properties:{color:"blue"}},{callback:v,properties:{color:"green"}}],others:{properties:{color:"green"}}}},legend:{visible:false},title:{visible:true,text:"Avisos per equip"}});r.connect(t.getVizUid());t.setModel(i,"oModelTotalAvisosLinia")}},createChartAvisosRuleRedEquips:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelClaseEquip");if(t){var r=t.getData();var a=e.Equip;var i=r.filter(function(e){if(e.Columna1===a){return e}else return""});if(i.length>0&&i[0].Color==="ERROR"){return true}}};return t},createChartAvisosRuleOrangeEquips:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelClaseEquip");if(t){var r=t.getData();var a=e.Equip;var i=r.filter(function(e){if(e.Columna1===a){return e}else return""});if(i.length>0&&i[0].Color==="WARNING"){return true}}};return t},createChartAvisosRuleBlueEquips:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelClaseEquip");if(t){var r=t.getData();var a=e.Equip;var i=r.filter(function(e){if(e.Columna1===a){return e}else return""});if(i.length>0&&i[0].Color==="INFORMATION"){return true}}};return t},createChartAvisosRuleGreenEquips:function(e){var t=function(e){var t=sap.ui.getCore().getModel("oModelClaseEquip");if(t){var r=t.getData();var a=e.Equip;var i=r.filter(function(e){if(e.Columna1===a){return e}else return""});if(i.length>0&&i[0].Color==="SUCCESS"){return true}}};return t},createChartDataStructure:function(e){var t,r,a=[],i,o;for(t=0;t<e.length;t++){i=0;for(r=0;r<e[t].Valors.length;r++){o=e[t].Valors[r];i+=e[t][o].AvisosQty}a.push({Prioritat:e[t].Columna,Color:e[t].Color,AvisosQty:i})}return a},createChartEquipDataStructure:function(e){var t,r,a=[],i,o;for(t=0;t<e.length;t++){i=0;o=e[t].Columna1;i=e[t].AvisosQty;a.push({Prioritat:o,Color:e[t].Color,AvisosQty:i})}return a},readTotalAvisosLinia:function(){var e="/TotalAvisosLiniaSet";var t=this.getOwnerComponent().getModel();var r=this.onSuccessReadTotalAvisosLinia;var a=this.genericErrorCallback;var i="tot_avis_prioritat,tot_avis_equip";this.readGenericCall(e,t,r,a,i)},onSuccessReadTotalAvisosLinia:function(e,t){if(t&&t.results&&t.results.length>0){var r=e.formatDataTotalAvisosLiniaReturn(e,t.results);e.setAuxModel(e,"oModelTotalAvisosLinia",r);e.fillEstacionsModelWithAvisos(e,r);e.setModelForGraphBV(e);e.setModelForGraphLA(e);e.setChartsData(e)}},formatDataTotalAvisosLiniaReturn:function(e,t){for(var r=0;r<t.length;r++){if(t[r].NomLinia==="DEPENDENCIA_BV"){t.DEPENDENCIA_BV=t[r]}else if(t[r].NomLinia==="DEPENDENCIA_LA"){t.DEPENDENCIA_LA=t[r]}}if(t.DEPENDENCIA_BV){if(t.DEPENDENCIA_BV.tot_avis_equip&&t.DEPENDENCIA_BV.tot_avis_equip.results&&t.DEPENDENCIA_BV.tot_avis_equip.results.length>0){t.DEPENDENCIA_BV.tot_avis_equip=t.DEPENDENCIA_BV.tot_avis_equip.results}else{t.DEPENDENCIA_BV.tot_avis_equip=[]}if(t.DEPENDENCIA_BV.tot_avis_prioritat&&t.DEPENDENCIA_BV.tot_avis_prioritat.results&&t.DEPENDENCIA_BV.tot_avis_prioritat.results.length>0){t.DEPENDENCIA_BV.tot_avis_prioritat=t.DEPENDENCIA_BV.tot_avis_prioritat.results}else{t.DEPENDENCIA_BV.tot_avis_prioritat=[]}e.formatDataAvisosPerEquipDependencia(e,t.DEPENDENCIA_BV,"Dependencia_BV")}if(t.DEPENDENCIA_LA){if(t.DEPENDENCIA_LA.tot_avis_equip&&t.DEPENDENCIA_LA.tot_avis_equip.results&&t.DEPENDENCIA_LA.tot_avis_equip.results.length>0){t.DEPENDENCIA_LA.tot_avis_equip=t.DEPENDENCIA_LA.tot_avis_equip.results}else{t.DEPENDENCIA_LA.tot_avis_equip=[]}if(t.DEPENDENCIA_LA.tot_avis_prioritat&&t.DEPENDENCIA_LA.tot_avis_prioritat.results&&t.DEPENDENCIA_LA.tot_avis_prioritat.results.length>0){t.DEPENDENCIA_LA.tot_avis_prioritat=t.DEPENDENCIA_LA.tot_avis_prioritat.results}else{t.DEPENDENCIA_LA.tot_avis_prioritat=[]}e.formatDataAvisosPerEquipDependencia(e,t.DEPENDENCIA_LA,"Dependencia_LA")}return t},formatDataAvisosPerEquipDependencia:function(e,t,r){var a=t.tot_avis_equip;var i=e.getView().getModel("oModelClaseEquip");if(i){t.ChartEquips=[];var o=i.getData();o=JSON.parse(JSON.stringify(o));var s=[];var n,l,u,v,c=0;for(n=0;n<o.length;n++){u=o[n];v=[];v=a.filter(function(e){if(e.ClaseEquip===u.Columna&&e.Numavis>0){c+=parseInt(e.Numavis);return e}else return""});if(u.Columna1!=="Altres"){if(v.length>0){t.ChartEquips.push({Equip:u.Columna1,Avisos:v,AvisosQty:c,Color:u.Color,Valors:u.Valors})}else{t.ChartEquips.push({Equip:u.Columna1,Avisos:[],AvisosQty:0,Color:u.Color,Valors:u.Valors})}}else{t.tot_avis_Altres=c}c=0}}},setChartsData:function(e){var t="DEPENDENCIA_BV";var r=e.getView().byId("idBulletChartPrioritatsBVVizFrame");var a=e.getView().byId("idBulletChartPrioritatsBVPopOver");e._setChartPrioritatsData(e,r,a,t);var i=e.getView().byId("idBulletChartEquipsBVVizFrame");var o=e.getView().byId("idBulletChartEquipsBVPopOver");e._setChartEquipsData(e,i,o,t);var s="DEPENDENCIA_LA";var n=e.getView().byId("idBulletChartPrioritatsLAVizFrame");var l=e.getView().byId("idBulletChartPrioritatsLAPopOver");e._setChartPrioritatsData(e,n,l,s);var u=e.getView().byId("idBulletChartEquipsLAVizFrame");var v=e.getView().byId("idBulletChartEquipsLAPopOver");e._setChartEquipsData(e,u,v,s)},_setChartPrioritatsData:function(e,t,r,a){var i=e.getView().getModel("oModelTotalAvisosLinia");var o=e.oBundle;if(i&&t){var s=ChartFormatter.DefaultPattern;var n=e.createChartAvisosRuleRed(e);var l=e.createChartAvisosRuleOrange(e);var u=e.createChartAvisosRuleBlue(e);var v=e.createChartAvisosRuleGreen(e);t.setVizProperties({plotArea:{dataLabel:{visible:true},dataPointStyle:{rules:[{callback:n,properties:{color:"red"}},{callback:l,properties:{color:"orange"}},{callback:u,properties:{color:"blue"}},{callback:v,properties:{color:"green"}}],others:{properties:{color:"green"}}}},legend:{visible:false},title:{visible:true,text:"Avisos per prioritat"}});r.connect(t.getVizUid());t.setModel(i,"oModelTotalAvisosLinia")}},readTotalAvisos:function(){var e="/TotalAvisosSet";var t=this.getOwnerComponent().getModel();var r=this.onSuccessReadTotalAvisos;var a=this.genericErrorCallback;var i="";this.readGenericCall(e,t,r,a,i)},onSuccessReadTotalAvisos:function(e,t){if(t&&t.results&&t.results.length>0){e.setAuxModel(e,"oModelTotalAvisos",t.results);e.fillEstacionsModelWithAvisos(e);e.setModelForGraphBV(e);e.setModelForGraphLA(e)}},fillEstacionsModelWithAvisos:function(e,t){var r=e.getModel("oModelEstacions");if(r){var a=r.getData();var i,o;for(i=0;i<a.BVNodes.length;i++){o=[];o=t.DEPENDENCIA_BV.tot_avis_equip.filter(function(e){if(e.EstacioUbicacio===a.BVNodes[i].Codiest){e.visible=true;return e}else return""});if(o.length>0){a.BVNodes[i].attributes=o}}for(i=0;i<a.LANodes.length;i++){o=[];o=t.DEPENDENCIA_LA.tot_avis_equip.filter(function(e){if(e.EstacioUbicacio===a.LANodes[i].Codiest){e.visible=true;return e}else return""});a.LANodes[i].attributes=o}}},readGenericCall:function(e,t,r,a,i){if(t){var o={};if(i){o["$expand"]=i}t.read(e,{urlParameters:o,success:jQuery.proxy(function(e){r(this,e)},this),error:jQuery.proxy(function(e){a(this,e)},this)})}},genericErrorCallback:function(e,t){if(e.responseText&&e.responseText!==""){jsonResponse=JSON.parse(e.responseText);if(jsonResponse.error&&jsonResponse.error.message&&jsonResponse.error.message.value){var r=t._oResourceBundle.getText("advertencia");var a=jsonResponse.error.message.value;ofertas.util.utils.onShowMessageDialog(r,"None",a,true,false,"",t)}else{var r=t._oResourceBundle.getText("advertencia");var a=t._oResourceBundle.getText("genericComunicationError");ofertas.util.utils.onShowMessageDialog(r,"None",a,true,false,"",t)}}},formatDataEstacionsReturn:function(e){var t={BVNodes:[],BVLines:[],LANodes:[],LALines:[]};var r,a,i,o,s;for(r=0;r<e.length;r++){e[r].Estacioseguent=e[r].Estacioseguent.split(";");s=e[r].Estacioseguent.length;e[r].Nivell=e[r].Nivell.split(";");i=e[r].Nivell[0];o=e[r].Nivell[1];e[r].laneId=parseFloat(i)*125;e[r].Nivell=parseFloat(o)*125;e[r].actionButtons=[{icon:"sap-icon://display"}];if(e[r].Linia==="DEPENDENCIA_BV"){t.BVNodes.push(e[r]);for(a=0;a<s;a++){if(e[r].Estacioseguent[a]!==""){t.BVLines.push({from:e[r].Codiest,to:e[r].Estacioseguent[a]})}}}else if(e[r].Linia==="DEPENDENCIA_LA"){t.LANodes.push(e[r]);for(a=0;a<s;a++){if(e[r].Estacioseguent[a]!==""){t.LALines.push({from:e[r].Codiest,to:e[r].Estacioseguent[a]})}}}}return t},customButtonGraphPress:function(e){if(e.getSource()){var t=e.getSource();if(t.getBindingContext("oModelEstacions")){var r=t.getBindingContext("oModelEstacions").getObject();this.setAuxModel(this,"oModelNodeDetail",r);this._getPopoverNodeDetailCustom("zpmdocmedicio.view.Fragments.NodeDetailCustom").openBy(t)}}},_getPopoverNodeDetailCustom:function(e){var t=this._oPopoverNodeDetail;if(!t){t=sap.ui.xmlfragment(e,this);this.getView().addDependent(t);this._oPopoverNodeDetail=t}return t},colorNodeDetailList:function(){var e=sap.ui.getCore().byId("nodeDetailList");if(e){var t=e.getItems();if(t.length>0){var r,a,i;for(var o=0;o<t.length;o++){r=t[o];r.removeStyleClass();a=r.getBindingContext("oModelNodeDetail").getObject();i="";switch(a.Prioritat){case"ALTA":i="customItemRed";break;case"MEDIA":i="customItemOrange";break;case"TRIMESTRAL":i="customItemOrange";break;case"BAJA":i="customItemGreen";break;default:break}if(i!=="")r.addStyleClass(i)}}}},getUniqueListBy:function(e,t){var r=[...new Map(e.map(e=>[e[t],e])).values()];return r},setAuxModel:function(e,t,r){var a=new sap.ui.model.json.JSONModel;a.setSizeLimit("9999");a.setData(r);e.getView().setModel(a,t)},onPressDataPointChartPrioritats:function(e){var t=e.getParameter("id");var r;var a=sap.ui.getCore().getModel("oModelPrioritats");if(a){var i=a.getData();if(t.lastIndexOf("idBulletChartPrioritatsBVVizFrame")!==-1){r="DEPENDENCIA_BV"}else{r="DEPENDENCIA_LA"}if(e.getParameter("data")&&e.getParameter("data").length>0){var o=e.getParameter("data")[0].data;var s=o.Prioritat;var n=i.filter(function(e){if(e.Columna===s){return e}else return""});if(n.length>0){var l=n[0].Valors;var u=sap.ushell.Container.getService("CrossApplicationNavigation");var v=u&&u.hrefForExternal({target:{semanticObject:"ZPM_FIORI",action:"Llistat_Avisos"},params:{ID:"BarPrioritatsNavigation",Dependencia:r,Prioritats:l}})||"";var c=window.location.href.split("#")[0]+v;sap.m.URLHelper.redirect(c,true)}}}},onPressDataPointChartEquips:function(e){var t=e.getParameter("id");var r;var a=sap.ui.getCore().getModel("oModelClaseEquip");if(a){var i=a.getData();if(t.lastIndexOf("idBulletChartEquipsBVVizFrame")!==-1){r="DEPENDENCIA_BV"}else{r="DEPENDENCIA_LA"}if(e.getParameter("data")&&e.getParameter("data").length>0){var o=e.getParameter("data")[0].data;var s=o.Equip;if(s!=="Altres"){var n=i.filter(function(e){if(e.Columna1===s){return e}else return""});if(n.length>0){var l=n[0].Valors;var u=sap.ushell.Container.getService("CrossApplicationNavigation");var v=u&&u.hrefForExternal({target:{semanticObject:"ZPM_FIORI",action:"Llistat_Avisos"},params:{ID:"BarEquipsNavigation",Dependencia:r,Equips:l}})||"";var c=window.location.href.split("#")[0]+v;sap.m.URLHelper.redirect(c,true)}}}}},onPressNodeGraphBV:function(e){var t=e.getSource().getTitle();var r=this.getView().byId("graphBV");var a="";if(r){var i=r.getToolbar();var o=i.getContent()[0];var s=o.getSelectedItem();if(s){a=this.recuperarGrupoPlanificadorDelEquipo(s.getKey())}}var n=sap.ushell.Container.getService("CrossApplicationNavigation");var l=n&&n.hrefForExternal({target:{semanticObject:"ZPM_FIORI",action:"Llistat_Avisos"},params:{ID:"GraphNavigation",Dependencia:"DEPENDENCIA_BV",Estacio:t,Equips:a}})||"";var u=window.location.href.split("#")[0]+l;sap.m.URLHelper.redirect(u,true)},onPressNodeGraphLA:function(e){var t=e.getSource().getTitle();var r=this.getView().byId("graphBV");var a="";if(r){var i=r.getToolbar();var o=i.getContent()[0];var s=o.getSelectedItem();if(s){a=this.recuperarGrupoPlanificadorDelEquipo(s.getKey())}}var n=sap.ushell.Container.getService("CrossApplicationNavigation");var l=n&&n.hrefForExternal({target:{semanticObject:"ZPM_FIORI",action:"Llistat_Avisos"},params:{ID:"GraphNavigation",Dependencia:"DEPENDENCIA_LA",Estacio:t,Equips:a}})||"";var u=window.location.href.split("#")[0]+l;sap.m.URLHelper.redirect(u,true)},recuperarGrupoPlanificadorDelEquipo:function(e){var t=sap.ui.getCore().getModel("oModelClaseEquip");if(t){var r=t.getData();if(e!=="Altres"&&e!==""){var a=r.filter(function(t){if(t.Columna===e){return t}else return""});if(a.length>0){var i=a[0].Valors;return i}else return""}else return""}},onPressNavList:function(e){var t=e.getSource().getBindingContext().getObject().Ordre;var r=sap.ushell.Container.getService("CrossApplicationNavigation");var a=r&&r.hrefForExternal({target:{semanticObject:"ZPM_FIORI",action:"Gest_Map"},params:{ID:t}})||"";var i=window.location.href.split("#")[0]+a;sap.m.URLHelper.redirect(i,true)}})});